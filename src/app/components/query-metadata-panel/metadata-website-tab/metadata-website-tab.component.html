<div class="p-6">
  <div class="space-y-4">
    <h3 class="text-sm font-semibold uppercase text-base-content/60">
      {{ 'metadata.websitePreview' | translate }}
    </h3>
    @if (searchResult(); as result) {
      <div class="space-y-3 text-sm">
        <div class="flex justify-between py-2 border-b border-base-300">
          <span class="flex flex-row text-base-content/70 gap-1">
            <i class="bi bi-clock-history me-1"></i
            >{{ 'metadata.website.snapshotDate' | translate }}
          </span>
          <span>{{ archiveDate() }}</span>
        </div>
        <div class="flex justify-between py-2 border-b border-base-300">
          <span class="flex flex-row font-semibold text-base-content/70 gap-1">
            <i class="bi bi-archive me-1"></i>{{ 'metadata.website.archive' | translate }}
          </span>
          <span class="text-xs break-all">{{ archiveName() }}</span>
        </div>
        @if (archiveHomepage(); as homepage) {
          <div class="flex justify-between items-center py-2 border-b border-base-300">
            <span class="flex flex-row font-semibold text-base-content/70 gap-1">
              <i class="bi bi-house me-1"></i>{{ 'metadata.website.homepage' | translate }}
            </span>
            <a
              [href]="homepage"
              target="_blank"
              rel="noopener noreferrer"
              class="text-primary hover:underline text-xs"
            >
              {{ homepage }}
              <i class="bi bi-box-arrow-up-right ms-1"></i>
            </a>
          </div>
        }
        <div class="flex justify-between py-2 border-b border-base-300">
          <span class="flex flex-row font-semibold text-base-content/70 gap-1">
            <i class="bi bi-link-45deg me-1"></i>{{ 'metadata.website.mementoApi' | translate }}
          </span>
          <span class="text-xs break-all">{{
            result._source.archive?.memento_api_url || 'N/A'
          }}</span>
        </div>
        @if (cdxApiUrl(); as cdxUrl) {
          <div class="flex justify-between py-2 border-b border-base-300">
            <span class="flex flex-row font-semibold text-base-content/70 gap-1">
              <i class="bi bi-database me-1"></i>{{ 'metadata.website.cdxApi' | translate }}
            </span>
            <span class="text-xs break-all">{{ cdxUrl }}</span>
          </div>
        }
        <div class="flex justify-between items-center py-2 border-b border-base-300">
          <span class="flex flex-row font-semibold text-base-content/70 gap-1">
            <i class="bi bi-box-arrow-up-right me-1"></i
            >{{ 'metadata.website.openSnapshot' | translate }}
          </span>
          <a
            [href]="mementoUrlString()"
            target="_blank"
            rel="noopener noreferrer"
            class="text-primary hover:underline text-xs"
          >
            {{ 'metadata.website.openInNewTab' | translate }}
            <i class="bi bi-arrow-right"></i>
          </a>
        </div>
      </div>
      @if (mementoUrl(); as url) {
        <div class="relative mt-4">
          @if (isIframeLoading() && !iframeError()) {
            <div
              class="absolute inset-0 flex items-center justify-center bg-base-200 rounded-lg border border-base-300 z-10"
            >
              <div class="flex flex-col items-center gap-3">
                <span class="loading loading-spinner loading-lg text-primary"></span>
                <p class="text-sm text-base-content/70">
                  {{ 'metadata.website.loadingSnapshot' | translate }}
                </p>
              </div>
            </div>
          }
          @if (iframeError()) {
            <div
              class="absolute inset-0 flex items-center justify-center bg-base-200 rounded-lg border border-error z-10"
            >
              <div class="flex flex-col items-center gap-3 text-error">
                <i class="bi bi-exclamation-triangle text-4xl"></i>
                <p class="text-sm font-semibold">
                  {{ 'metadata.website.failedToLoad' | translate }}
                </p>
                <p class="text-xs text-base-content/60">
                  {{ 'metadata.website.archiveUnavailable' | translate }}
                </p>
              </div>
            </div>
          }
          <iframe
            [src]="url"
            class="w-full h-[500px] border border-base-300 rounded-lg"
            sandbox="allow-scripts allow-same-origin allow-popups"
            referrerpolicy="no-referrer"
            loading="eager"
            [title]="'metadata.website.iframeTitle' | translate: { date: archiveDate() }"
            (load)="onIframeLoad()"
            (error)="onIframeError()"
          ></iframe>
        </div>
      }
      <p class="text-xs text-base-content/50 mt-3">
        <i class="bi bi-info-circle me-1"></i>
        {{ 'metadata.website.previewNote' | translate }}
      </p>
    }
  </div>
</div>
